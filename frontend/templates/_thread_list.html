{% if results|length == 0 %}
<div class="no-result">
    <div class="icon">ğŸ˜•</div>
    <h3>æ‰¾ä¸åˆ°ç›¸é—œå°è©±</h3>
    <p>æ²’æœ‰æ‰¾åˆ°åŒ…å« "{{ target_name }}" çš„å°è©±ç´€éŒ„</p>
</div>
{% else %}
{% for thread in results %}
<div class="thread-card expanded" id="thread-{{ thread.thread_id }}">
    <div class="thread-header" onclick="toggleThread(this)" style="flex-wrap: wrap;">
        <h3>å°è©± #{{ loop.index + (page_index * 10) }}</h3>
        <div class="thread-center-action">
            <span class="toggle-icon">â–¼</span>
        </div>
        <div class="thread-meta">
            <span class="thread-time">ğŸ“… {{ thread.time }}</span>
            <span class="thread-id" style="margin-bottom: 5px;">ID: {{ thread.thread_id }}</span>
            <a href="/download/pdf/{{ thread.thread_id }}" onclick="event.stopPropagation()"
                class="btn-pdf btn-thread-pdf">
                ğŸ“„ PDF
            </a>
        </div>
        {% if thread.remark %}
        <div class="thread-remark"
            style="flex-basis: 100%; margin-top: 8px; padding-top: 8px; border-top: 1px dashed #eee; color: var(--text-secondary); font-size: 0.9em; word-break: break-all;">
            ğŸ“ {{ thread.remark }}
        </div>
        {% endif %}
    </div>
    <div class="thread-body">
        <div class="messages">
            {% for msg in thread.messages %}
            <div class="message {{ msg.role_class }}">
                <div class="message-header">
                    <span class="role-name">{{ msg.time }}</span>
                    <span class="role-icon">{{ msg.role_icon }}</span>
                    <span class="role-name">{{ msg.role_name }}</span>
                </div>
                <div class="message-content">{{ msg.content | trim | render_markdown | sanitize_html }}</div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endfor %}
{% endif %}