<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœå°‹çµæœ - {{ target_name }}</title>
    <!-- Link Style.css for Background Themes -->
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- Specialized Result Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/result.css') }}">
</head>

<body class="auth-layout">
    <!-- Orbs for Glass Theme -->
    <div class="orb-1"></div>
    <div class="orb-2"></div>

    <div class="container">
        <div class="header">
            <h1>ğŸ” æœå°‹çµæœ</h1>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-label">é—œéµå­—</div>
                    <div class="stat-value">{{ target_name }}</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">æ‰¾åˆ°å°è©±</div>
                    <div class="stat-value">{{ count }}</div>
                </div>
                {% if target_time and count > 0 %}
                <div class="stat-item">
                    <div class="stat-label">æœå°‹æ™‚é–“</div>
                    <div class="stat-value">{{ target_time }}</div>
                </div>
                {% endif %}
                {% if date_range %}
                <div class="stat-item">
                    <div class="stat-label">æ—¥æœŸç¯„åœ</div>
                    <div class="stat-value">{{ date_range }}</div>
                </div>
                {% endif %}
            </div>
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

        <!-- Removed Form Wrapper -->
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

        <!-- Removed Action Bar -->

        <!-- Removed Select All -->

        <!-- Thread List Container -->
        <div id="thread-list-container">
            {% include '_thread_list.html' %}
        </div>

        <!-- Pagination (Hidden from flow, moved to floating toolbar) -->
        <div style="height: 100px;"></div> <!-- Spacer for toolbar -->

        <!-- End Form Replacement -->

    </div>

    <!-- Floating Toolbar (Pagination + Back) -->
    <div class="floating-toolbar">
        <a href="/" class="toolbar-btn primary">
            <span>ğŸ”</span> è¿”å›æœå°‹
        </a>

        <div style="width: 1px; height: 20px; background: #ddd; margin: 0 5px;"></div>

        <button id="prevBtn" onclick="changePage(-1)" class="toolbar-btn" {% if current_page==0 %}disabled{% endif %}>
            Â« ä¸Šé 
        </button>

        <span id="pageInfo" class="toolbar-info">
            {{ current_page + 1 }} / {{ total_pages }}
        </span>

        <button id="nextBtn" onclick="changePage(1)" class="toolbar-btn" {% if current_page>= total_pages - 1
            %}disabled{% endif %}>
            ä¸‹é  Â»
        </button>
    </div>

    <button id="scrollTopBtn" class="scroll-top-btn" title="å›åˆ°é ‚éƒ¨">â†‘</button>

    <!-- Result Configurations -->
    <script type="application/json" id="server-data-debug-log">
        {{ debug_log | default([]) | tojson | safe }}
    </script>
    <script>
        window.THREAD_CONFIG = {
            totalPages: parseInt("{{ total_pages | default(1) }}", 10),
            currentPage: parseInt("{{ current_page | default(0) }}", 10),
            taskId: "{{ task_id | default('') }}",
            debugLog: JSON.parse(document.getElementById('server-data-debug-log').textContent)
        };
    </script>

    <!-- Download Modal -->
    <div id="downloadModal">
        <div class="modal-content">
            <div class="loader"></div>
            <h3>æ­£åœ¨è£½ä½œä¸¦ä¸‹è¼‰ PDF...</h3>
            <p style="color: #666; margin-bottom: 20px; font-size: 14px;">å°è©±å…§å®¹è¼ƒé•·æ™‚å¯èƒ½éœ€è¦ä¸€é»æ™‚é–“</p>
            <button class="btn-cancel" onclick="cancelDownload()">å–æ¶ˆä¸‹è¼‰</button>
        </div>
    </div>

    <!-- Core Logic -->
    <script src="{{ url_for('static', filename='js/result.js') }}"></script>
</body>

</html>